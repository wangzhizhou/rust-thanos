# rust-thanos

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Rust](https://github.com/wangzhizhou/rust-thanos/actions/workflows/ci.yml/badge.svg)](https://github.com/wangzhizhou/rust-thanos/actions/workflows/ci.yml)

ä¸€ä¸ªé«˜æ•ˆçš„ Minecraft Java ä¸–ç•Œä¼˜åŒ–å·¥å…·ï¼Œç”¨äºæ£€æµ‹å¹¶åˆ é™¤æœªä½¿ç”¨çš„åŒºå—ï¼Œå‡å°‘ä¸–ç•Œæ–‡ä»¶å¤§å°ï¼Œæé«˜æ¸¸æˆæ€§èƒ½ã€‚

## ğŸŒŸ ç‰¹æ€§

- **æ™ºèƒ½åŒºå—æ£€æµ‹**ï¼šé€šè¿‡ `InhabitedTime` å’Œå¼ºåŠ è½½åŒºå—åˆ—è¡¨åˆ¤å®šåŒºå—æ˜¯å¦è¢«ä½¿ç”¨
- **å¤šç§å‹ç¼©æ ¼å¼æ”¯æŒ**ï¼šå…¼å®¹ RAWã€ZLIBã€GZIPã€LZ4 Blockï¼ˆå«æ ¡éªŒï¼‰
- **é«˜æ•ˆå¤„ç†**ï¼šå¿«é€Ÿå­—èŠ‚å®šä½ï¼Œé¿å…å®Œæ•´ NBT è§£æï¼Œæé«˜å¤„ç†é€Ÿåº¦
- **å¹¶è¡Œå¤„ç†**ï¼šåˆ©ç”¨å¤šæ ¸ CPU åŠ é€Ÿå¤„ç†è¿‡ç¨‹
- **çµæ´»é…ç½®**ï¼šæ”¯æŒè‡ªå®šä¹‰ `InhabitedTime` é˜ˆå€¼å’Œå¤šç§è¿›åº¦æ˜¾ç¤ºæ¨¡å¼
- **å®‰å…¨å¯é **ï¼šè¯¦ç»†çš„é”™è¯¯å¤„ç†å’Œå®¹é”™æœºåˆ¶ï¼Œç¡®ä¿æ•°æ®å®‰å…¨
- **å¤šç§ä½¿ç”¨æ¨¡å¼**ï¼šæ”¯æŒè¾“å‡ºåˆ°æ–°ç›®å½•æˆ–åŸåœ°æ›¿æ¢
- **é€’å½’ç»´åº¦è¯†åˆ«**ï¼šè‡ªåŠ¨æ‰«æè¾“å…¥ç›®å½•ä¸‹æ‰€æœ‰å« region çš„ç»´åº¦ç›®å½•ï¼ˆVanilla çš„ DIM-1/DIM1ï¼ŒPaper çš„ world_nether/world_the_end ä»¥åŠè‡ªå®šä¹‰ç»´åº¦ï¼‰
- **ä¾¿æ·å½’æ¡£**ï¼šéåŸåœ°æ¨¡å¼ä¸‹æ”¯æŒå°†è¾“å‡ºç›®å½•å‹ç¼©ä¸º zipï¼Œå¹¶æŒ‰ `YYYYMMddHHmmss.zip` å‘½åï¼Œå‹ç¼©å®Œæˆåè‡ªåŠ¨åˆ é™¤è¾“å‡ºç›®å½•
- **å‹å¥½è¿›åº¦æ˜¾ç¤º**ï¼šè¿›åº¦æ¡è‡ªé€‚åº”ç»ˆç«¯å®½åº¦ï¼Œæœ€å¤šæ˜¾ç¤º 50 ä¸ª bar

## ğŸ“¦ å®‰è£…

### é€šè¿‡ Homebrew å®‰è£…

```bash
brew tap orzgeeker/core && brew install rust-thanos
```

### ä»æºä»£ç æ„å»º

1. å…‹éš†ä»“åº“å¹¶è¿›å…¥ç›®å½•ï¼š
   ```bash
   git clone https://github.com/wangzhizhou/rust-thanos.git
   cd rust-thanos
   ```

2. æ„å»ºé¡¹ç›®ï¼š
   ```bash
   cargo build --release
   ```

3. è¿è¡Œæµ‹è¯•ï¼ˆå¯é€‰ï¼‰ï¼š
   ```bash
   cargo test
   ```

4. å®‰è£…åˆ°ç³»ç»Ÿï¼ˆå¯é€‰ï¼‰ï¼š
   ```bash
   cargo install --path .
   ```

### ä¸‹è½½é¢„ç¼–è¯‘äºŒè¿›åˆ¶æ–‡ä»¶

é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶å¯åœ¨ [Releases](https://github.com/wangzhizhou/rust-thanos/releases) é¡µé¢ä¸‹è½½ã€‚

## ğŸš€ ä½¿ç”¨

### åŸºæœ¬è¯­æ³•

```bash
rust-thanos WORLD_DIR [OUTPUT_DIR] \
  [-t|--inhabited-time-seconds <seconds>] [--remove-unknown] \
  [--progress-mode <mode>] [--in-place] [--zip-output] [-f|--force]
```

### å‚æ•°è¯´æ˜

| å‚æ•° | æè¿° |
|------|------|
| `WORLD_DIR` | Minecraft ä¸–ç•Œæ ¹ç›®å½•ï¼ˆå¿…å¡«ï¼‰ |
| `OUTPUT_DIR` | è¾“å‡ºç›®å½•ï¼Œå¿…é¡»ä¸ºç©ºï¼›å½“ç›®å½•å·²å­˜åœ¨ä¸”éç©ºå°†æç¤ºæ˜¯å¦è¦†ç›–ï¼›ä½¿ç”¨ `-f` å¯è·³è¿‡æç¤ºï¼›è‹¥æœªæä¾›å°†ä½¿ç”¨ä¸´æ—¶ç›®å½•å¹¶æœ€ç»ˆæ›¿æ¢è¾“å…¥ç›®å½• |
| `-t, --inhabited-time-seconds` | ä»¥ç§’ä¸ºå•ä½è®¾ç½® `InhabitedTime` é˜ˆå€¼ï¼ˆ1s=20 ticksï¼‰ï¼Œé»˜è®¤ `300` |
| `--remove-unknown` | å¯¹æœªçŸ¥æˆ–å¤–éƒ¨å‹ç¼©åŒºå—è§†ä¸ºå¯åˆ é™¤ï¼Œé»˜è®¤å…³é—­ |
| `--progress-mode` | è¿›åº¦æ˜¾ç¤ºæ¨¡å¼ï¼š`off`ï¼ˆå…³é—­ï¼‰ã€`global`ï¼ˆå…¨å±€è¿›åº¦ï¼‰ã€`region`ï¼ˆåŒºåŸŸè¿›åº¦ï¼‰ï¼Œé»˜è®¤ `region` |
| `--in-place` | åŸåœ°å¤„ç†ï¼šå¿½ç•¥ `OUTPUT_DIR`ï¼Œç›´æ¥æ›¿æ¢åŸä¸–ç•Œç›®å½• |
| `--zip-output` | éåŸåœ°æ¨¡å¼ä¸‹å°† `OUTPUT_DIR` å‹ç¼©ä¸º zipï¼ˆ`YYYYMMddHHmmss.zip`ï¼‰ï¼Œå¹¶åœ¨å‹ç¼©å®Œæˆååˆ é™¤ `OUTPUT_DIR` |
| `-f, --force` | å½“ `OUTPUT_DIR` å·²å­˜åœ¨ä¸”éç©ºæ—¶å¼ºåˆ¶è¦†ç›–ï¼Œä¸è¿›è¡Œäº¤äº’æç¤ºï¼›é»˜è®¤ä¼šæç¤ºé€‰æ‹©æ˜¯å¦è¦†ç›– |

### å®ç”¨ç¤ºä¾‹

#### 1. åŸºæœ¬ä½¿ç”¨ - è¾“å‡ºåˆ°æ–°ç›®å½•
```bash
rust-thanos /path/to/world /path/to/output
```

#### 2. è‡ªå®šä¹‰ `InhabitedTime` é˜ˆå€¼ï¼ˆ10 åˆ†é’Ÿï¼‰
```bash
rust-thanos /path/to/world /path/to/output --inhabited-time-seconds 600
```

#### 3. åŸåœ°æ›¿æ¢ä¸–ç•Œæ–‡ä»¶
```bash
rust-thanos /path/to/world --in-place
```

#### 4. ç§»é™¤æœªçŸ¥å‹ç¼©æ ¼å¼çš„åŒºå—
```bash
rust-thanos /path/to/world /path/to/output --remove-unknown
```

#### 5. ä½¿ç”¨å…¨å±€è¿›åº¦æ˜¾ç¤º
```bash
rust-thanos /path/to/world /path/to/output --progress-mode global
```

#### 6. å‹ç¼©è¾“å‡ºç›®å½•ï¼ˆå¹¶åˆ é™¤è¾“å‡ºç›®å½•ï¼‰
```bash
rust-thanos /path/to/world /path/to/output --zip-output
# è¾“å‡ºï¼š
# å¼€å§‹å‹ç¼©: /path/to/output â†’ /path/to/20250101123045.zip
# zip: /path/to/20250101123045.zip
```

#### 6. ä½¿ç”¨é¡¹ç›®å†…ç½®æµ‹è¯•ä¸–ç•Œ
```bash
cargo run -- tests/Fixtures/world ./out
```

#### 7. å¼ºåˆ¶è¦†ç›–è¾“å‡ºç›®å½•
```bash
rust-thanos /path/to/world /path/to/output -f
```

> æç¤ºï¼šå‘½ä»¤è¡Œå¸®åŠ©æ–‡æœ¬ä¸ºè‹±æ–‡ï¼Œå¯é€šè¿‡ `rust-thanos --help` æŸ¥çœ‹å®Œæ•´è¯´æ˜ä¸ç¤ºä¾‹ã€‚

## ğŸ”§ å·¥ä½œåŸç†

1. **ä¸–ç•Œæ‰«æ**ï¼šè¯†åˆ«æ‰€æœ‰ç»´åº¦ç›®å½•å’Œ `.mca` æ–‡ä»¶ï¼ˆé€’å½’æ‰«æè¾“å…¥ç›®å½•ä¸‹æ‰€æœ‰å« `region` çš„ç»´åº¦ç›®å½•ï¼‰
2. **å¼ºåŠ è½½åŒºå—è§£æ**ï¼šä» `data/chunks.dat` è¯»å–å¼ºåŠ è½½åŒºå—åˆ—è¡¨
3. **åŒºå—åˆ†æ**ï¼š
   - è¯»å–æ¯ä¸ª `.mca` æ–‡ä»¶çš„åŒºå—æ¡ç›®
   - æ£€æŸ¥åŒºå—çš„ `InhabitedTime` æ˜¯å¦è¶…è¿‡é˜ˆå€¼
   - æ£€æŸ¥åŒºå—æ˜¯å¦åœ¨å¼ºåŠ è½½åˆ—è¡¨ä¸­
4. **åŒºå—è¿‡æ»¤**ï¼šåªä¿ç•™ç¬¦åˆæ¡ä»¶çš„åŒºå—
5. **è¾“å‡ºç»“æœ**ï¼šå†™å…¥ä¿ç•™çš„åŒºå—åˆ°æ–°æ–‡ä»¶æˆ–åŸåœ°æ›¿æ¢
6. **ç»Ÿè®¡æŠ¥å‘Š**ï¼šæ˜¾ç¤ºå¤„ç†ç»“æœå’Œæ€§èƒ½ç»Ÿè®¡

## ğŸ“Š æ€§èƒ½

- **å¤„ç†é€Ÿåº¦**ï¼šå–å†³äº CPU æ ¸å¿ƒæ•°å’Œä¸–ç•Œå¤§å°ï¼Œé€šå¸¸æ¯ç§’å¯å¤„ç†æ•°åƒä¸ªåŒºå—
- **å†…å­˜ä½¿ç”¨**ï¼šé«˜æ•ˆçš„å†…å­˜ç®¡ç†ï¼Œé€‚åˆå¤„ç†å¤§å‹ä¸–ç•Œ
- **ç£ç›˜ I/O**ï¼šä¼˜åŒ–çš„è¯»å†™æ“ä½œï¼Œå‡å°‘ç£ç›˜è®¿é—®

## ğŸ›¡ï¸ å®‰å…¨æ³¨æ„äº‹é¡¹

1. **å¤‡ä»½å»ºè®®**ï¼šåœ¨å¤„ç†é‡è¦ä¸–ç•Œä¹‹å‰ï¼Œå»ºè®®åˆ›å»ºå¤‡ä»½
2. **åŸåœ°å¤„ç†é£é™©**ï¼šä½¿ç”¨ `--in-place` é€‰é¡¹æ—¶ï¼Œè¯·ç¡®ä¿æœ‰è¶³å¤Ÿçš„ç£ç›˜ç©ºé—´
3. **æœªçŸ¥å‹ç¼©å¤„ç†**ï¼šè°¨æ…ä½¿ç”¨ `--remove-unknown` é€‰é¡¹ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®ä¸¢å¤±

## ğŸ“ æŠ€æœ¯ç»†èŠ‚

### æ”¯æŒçš„æ–‡ä»¶ç±»å‹

- ä¸»ä¸–ç•Œæ–‡ä»¶ï¼š`region/r.*.*.mca`
- å®ä½“æ–‡ä»¶ï¼š`entities/r.*.*.mca`
- å…´è¶£ç‚¹æ–‡ä»¶ï¼š`poi/r.*.*.mca`

### åŒºå—ä¿ç•™è§„åˆ™

åŒºå—ä¼šè¢«ä¿ç•™å¦‚æœï¼š
1. `InhabitedTime` å¤§äºæˆ–ç­‰äºè®¾å®šçš„é˜ˆå€¼
2. åŒºå—åœ¨å¼ºåŠ è½½åˆ—è¡¨ä¸­
3. åŒºå—ä½¿ç”¨æœªçŸ¥å‹ç¼©æ ¼å¼ä¸”æœªå¯ç”¨ `--remove-unknown`

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

### å¼€å‘æµç¨‹

1. Fork ä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ï¼š`git checkout -b feature/AmazingFeature`
3. æäº¤æ›´æ”¹ï¼š`git commit -m 'Add some AmazingFeature'`
4. æ¨é€åˆ°åˆ†æ”¯ï¼š`git push origin feature/AmazingFeature`
5. å¼€å¯ Pull Request

## ğŸ§ª æµ‹è¯•

é¡¹ç›®åŒ…å«å…¨é¢çš„æµ‹è¯•å¥—ä»¶ï¼Œä½¿ç”¨å†…ç½®çš„æµ‹è¯•ä¸–ç•Œè¿›è¡Œæµ‹è¯•ï¼š

```bash
cargo test
```

## ğŸ–¥ï¸ å¹³å°æ”¯æŒ

- **æ¨èå¹³å°**ï¼šLinux/macOSï¼ˆåŒæ—¶æ”¯æŒ x86_64 ä¸ ARM64ï¼‰
- **Windows**ï¼šå»ºè®®ä½¿ç”¨ WSL è·å–æ›´å¥½çš„å¹¶å‘æ€§èƒ½

> é€šè¿‡ Homebrew Tap å®‰è£…çš„å…¬å¼åŒæ—¶æ”¯æŒ macOS ä¸ Linuxï¼›å‘å¸ƒæµç¨‹ä¼šä¸º macOSï¼ˆarm64/x64ï¼‰ä¸ Linuxï¼ˆx64/arm64ï¼‰ç”Ÿæˆå¯¹åº”çš„å‹ç¼©åŒ…ä¸æ ¡éªŒã€‚

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…

## ğŸ“ è”ç³»æ–¹å¼

- é¡¹ç›®é“¾æ¥ï¼š[https://github.com/wangzhizhou/rust-thanos](https://github.com/wangzhizhou/rust-thanos)
- æŠ¥å‘Šé—®é¢˜ï¼š[Issues](https://github.com/wangzhizhou/rust-thanos/issues)

## ğŸ“š ç›¸å…³é“¾æ¥

- [Minecraft ç»´åŸºç™¾ç§‘ - åŒºåŸŸæ–‡ä»¶](https://minecraft.fandom.com/wiki/Region_file_format)
- [NBT æ ¼å¼è§„èŒƒ](https://minecraft.fandom.com/wiki/NBT_format)
- [Rust ç¼–ç¨‹è¯­è¨€](https://www.rust-lang.org/)

## ğŸ“ˆ ç»Ÿè®¡

ä½¿ç”¨ rust-thanos åï¼Œæ‚¨å¯ä»¥æœŸå¾…ï¼š
- å‡å°‘ 50-90% çš„ä¸–ç•Œæ–‡ä»¶å¤§å°ï¼ˆå–å†³äºä¸–ç•Œä½¿ç”¨æƒ…å†µï¼‰
- æé«˜æ¸¸æˆåŠ è½½é€Ÿåº¦
- å‡å°‘æœåŠ¡å™¨å†…å­˜ä½¿ç”¨

---

**rust-thanos** - è®©æ‚¨çš„ Minecraft ä¸–ç•Œæ›´åŠ é«˜æ•ˆï¼ ğŸš€
